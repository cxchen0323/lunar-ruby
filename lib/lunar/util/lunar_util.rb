module Lunar
  class LunarUtil
    BASE_MONTH_ZHI_INDEX = 2
    XUN = %w[甲子 甲戌 甲申 甲午 甲辰 甲寅].freeze
    XUN_KONG = %w[戌亥 申酉 午未 辰巳 寅卯 子丑].freeze
    LIU_YAO = %w[先胜 友引 先负 佛灭 大安 赤口].freeze
    HOU = %w[初候 二候 三候].freeze
    WU_HOU = %w[蚯蚓结 麋角解 水泉动 雁北乡 鹊始巢 雉始雊 鸡始乳 征鸟厉疾 水泽腹坚 东风解冻 蛰虫始振 鱼陟负冰 獭祭鱼 候雁北 草木萌动 桃始华 仓庚鸣 鹰化为鸠 玄鸟至 雷乃发声 始电 桐始华 田鼠化为鴽 虹始见 萍始生 鸣鸠拂奇羽 戴胜降于桑 蝼蝈鸣 蚯蚓出 王瓜生 苦菜秀 靡草死 麦秋至 螳螂生 鵙始鸣 反舌无声 鹿角解 蜩始鸣 半夏生 温风至 蟋蟀居壁 鹰始挚 腐草为萤 土润溽暑 大雨行时 凉风至 白露降 寒蝉鸣 鹰乃祭鸟 天地始肃 禾乃登 鸿雁来 玄鸟归 群鸟养羞 雷始收声 蛰虫坯户 水始涸 鸿雁来宾 雀入大水为蛤 菊有黄花 豺乃祭兽 草木黄落 蛰虫咸俯 水始冰 地始冻 雉入大水为蜃 虹藏不见 天气上升地气下降 闭塞而成冬 鹖鴠不鸣 虎始交 荔挺出].freeze
    GAN = ['', '甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'].freeze
    POSITION_XI = ['', '艮', '乾', '坤', '离', '巽', '艮', '乾', '坤', '离', '巽'].freeze
    POSITION_YANG_GUI = ['', '坤', '坤', '兑', '乾', '艮', '坎', '离', '艮', '震', '巽'].freeze
    POSITION_YIN_GUI = ['', '艮', '坎', '乾', '兑', '坤', '坤', '艮', '离', '巽', '震'].freeze
    POSITION_FU = ['', '巽', '巽', '震', '震', '坎', '离', '坤', '坤', '乾', '兑'].freeze
    POSITION_FU_2 = ['', '坎', '坤', '乾', '巽', '艮', '坎', '坤', '乾', '巽', '艮'].freeze
    POSITION_CAI = ['', '艮', '艮', '坤', '坤', '坎', '坎', '震', '震', '离', '离'].freeze
    POSITION_TAI_SUI_YEAR = %w[坎 艮 艮 震 巽 巽 离 坤 坤 兑 坎 坎].freeze
    POSITION_GAN = %w[震 震 离 离 中 中 兑 兑 坎 坎].freeze
    POSITION_ZHI = %w[坎 中 震 震 中 离 离 中 兑 兑 中 坎].freeze
    POSITION_TAI_DAY = [
      '占门碓 外东南', '碓磨厕 外东南', '厨灶炉 外正南',
      '门鸡栖 外西南', '占大门 外西南', '碓磨床 外正西',
      '厨灶堂 外西北', '仓库门 外西北', '占房床 外正北',
      '占门厕 外东北', '碓磨栖 外东北', '厨灶床 外正东'
    ].freeze
    POSITION_TAI_MONTH = %w[占房床 占户窗 占门堂 占厨灶 占房床 占床仓 占碓磨 占厕户 占门房 占房床 占灶炉 占房床].freeze
    ZHI = ['', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'].freeze
    JIA_ZI = %w[甲子 乙丑 丙寅 丁卯 戊辰 己巳 庚午 辛未 壬申 癸酉 甲戌 乙亥 丙子 丁丑 戊寅 己卯 庚辰 辛巳 壬午 癸未 甲申 乙酉 丙戌 丁亥 戊子 己丑 庚寅 辛卯 壬辰 癸巳 甲午 乙未 丙申 丁酉 戊戌 己亥 庚子 辛丑 壬寅 癸卯 甲辰 乙巳 丙午 丁未 戊申 己酉 庚戌 辛亥 壬子 癸丑 甲寅 乙卯 丙辰 丁巳 戊午 己未 庚申 辛酉 壬戌 癸亥].freeze
    
    # 纳音
    NA_YIN = %w[海中金 海中金 炉中火 炉中火 大林木 大林木 路旁土 路旁土 剑锋金 剑锋金 山头火 山头火 涧下水 涧下水 城头土 城头土 白蜡金 白蜡金 杨柳木 杨柳木 泉中水 泉中水 屋上土 屋上土 霹雳火 霹雳火 松柏木 松柏木 长流水 长流水 沙中金 沙中金 山下火 山下火 平地木 平地木 壁上土 壁上土 金箔金 金箔金 覆灯火 覆灯火 天河水 天河水 大驿土 大驿土 钗钏金 钗钏金 桑柘木 桑柘木 大溪水 大溪水 沙中土 沙中土 天上火 天上火 石榴木 石榴木 大海水 大海水].freeze
    
    # 地支相冲
    ZHI_XING_CHONG = {
      '子' => ['午'],
      '丑' => ['未'],
      '寅' => ['申'],
      '卯' => ['酉'],
      '辰' => ['戌'],
      '巳' => ['亥'],
      '午' => ['子'],
      '未' => ['丑'],
      '申' => ['寅'],
      '酉' => ['卯'],
      '戌' => ['辰'],
      '亥' => ['巳']
    }.freeze
    
    # 天干相冲
    GAN_XING_CHONG = {
      '甲' => ['庚'],
      '乙' => ['辛'],
      '丙' => ['壬'],
      '丁' => ['癸'],
      '庚' => ['甲'],
      '辛' => ['乙'],
      '壬' => ['丙'],
      '癸' => ['丁']
    }.freeze
    
    # 地支相合
    ZHI_XING_HE = {
      '子' => ['丑'],
      '丑' => ['子'],
      '寅' => ['亥'],
      '卯' => ['戌'],
      '辰' => ['酉'],
      '巳' => ['申'],
      '午' => ['未'],
      '未' => ['午'],
      '申' => ['巳'],
      '酉' => ['辰'],
      '戌' => ['卯'],
      '亥' => ['寅']
    }.freeze
    
    # 天干相合
    GAN_XING_HE = {
      '甲' => ['己'],
      '乙' => ['庚'],
      '丙' => ['辛'],
      '丁' => ['壬'],
      '戊' => ['癸'],
      '己' => ['甲'],
      '庚' => ['乙'],
      '辛' => ['丙'],
      '壬' => ['丁'],
      '癸' => ['戊']
    }.freeze

    # 每月初一的天干偏移
    MONTH1_GAN_OFFSET = [0, 2, 4, 6, 8, 0, 2, 4, 6, 8].freeze
    
    # 每月初一的地支偏移
    MONTH1_ZHI_OFFSET = [0, 2, 4, 6, 8, 10, 0, 2, 4, 6, 8, 10].freeze
    
    # 每月生肖
    MONTH_ZHI = %w[寅 卯 辰 巳 午 未 申 酉 戌 亥 子 丑].freeze
    
    # 每月建
    MONTH_JIAN = %w[建 除 满 平 定 执 破 危 成 收 开 闭].freeze
    
    # 地支生肖
    ZHI_SHENG_XIAO = %w[鼠 牛 虎 兔 龙 蛇 马 羊 猴 鸡 狗 猪].freeze
    
    # 彭祖百忌天干
    PENG_ZU_GAN = [
      '甲不开仓财物耗散',
      '乙不栽植千株不长',
      '丙不修灶必见灾殃',
      '丁不剃头头必生疮',
      '戊不受田田主不祥',
      '己不破券二比并亡',
      '庚不经络织机虚张',
      '辛不合酱主人不尝',
      '壬不泱水更难提防',
      '癸不词讼理弱敌强'
    ].freeze
    
    # 彭祖百忌地支
    PENG_ZU_ZHI = [
      '子不问卜自惹祸殃',
      '丑不冠带主不还乡',
      '寅不祭祀神鬼不尝',
      '卯不穿井水泉不香',
      '辰不哭泣必主重丧',
      '巳不远行财物伏藏',
      '午不苫盖屋主更张',
      '未不服药毒气入肠',
      '申不安床鬼祟入房',
      '酉不会客醉坐颠狂',
      '戌不吃犬作怪上床',
      '亥不嫁娶不利新郎'
    ].freeze
    
    # 数字
    NUMBER = %w[〇 一 二 三 四 五 六 七 八 九].freeze
    
    # 月份
    MONTH = %w[正 二 三 四 五 六 七 八 九 十 冬 腊].freeze
    
    # 节气
    JIE = %w[小寒 立春 惊蛰 清明 立夏 芒种 小暑 立秋 白露 寒露 立冬 大雪].freeze
    
    # 中气
    QI = %w[冬至 大寒 雨水 春分 谷雨 小满 夏至 大暑 处暑 秋分 霜降 小雪].freeze
    
    # 节气和中气
    JIE_QI = %w[冬至 小寒 大寒 立春 雨水 惊蛰 春分 清明 谷雨 立夏 小满 芒种 夏至 小暑 大暑 立秋 处暑 白露 秋分 寒露 霜降 立冬 小雪 大雪].freeze
    
    # 节气偏移
    JIE_QI_OFFSET = [0, 21208, 43467, 63836, 85337, 107014, 128867, 150921, 173149, 195551, 218072, 240693, 263343, 285989, 308563, 331033, 353350, 375494, 397447, 419210, 440795, 462224, 483532, 504758].freeze

    # Utility methods
    def self.get_gan(index)
      GAN[index % GAN.length]
    end

    def self.get_zhi(index)
      ZHI[index % ZHI.length]
    end

    def self.get_gan_index(gan)
      GAN.index(gan)
    end

    def self.get_zhi_index(zhi)
      ZHI.index(zhi)
    end

    def self.get_jia_zi_index(gan_zhi)
      JIA_ZI.index(gan_zhi)
    end

    def self.get_xun(gan_zhi)
      XUN[get_jia_zi_index(gan_zhi) / 10]
    end

    def self.get_xun_kong(gan_zhi)
      XUN_KONG[get_jia_zi_index(gan_zhi) / 10]
    end

    def self.find(name, names, offset)
      names.each_with_index do |n, i|
        return i + offset if n == name
      end
      -1
    end

    # 二十八宿
    XIU = {
      '申1' => '毕', '申2' => '翼', '申3' => '箕', '申4' => '奎', '申5' => '鬼', '申6' => '氐', '申0' => '虚',
      '子1' => '毕', '子2' => '翼', '子3' => '箕', '子4' => '奎', '子5' => '鬼', '子6' => '氐', '子0' => '虚',
      '辰1' => '毕', '辰2' => '翼', '辰3' => '箕', '辰4' => '奎', '辰5' => '鬼', '辰6' => '氐', '辰0' => '虚',
      
      '巳1' => '轸', '巳2' => '觜', '巳3' => '斗', '巳4' => '胃', '巳5' => '柳', '巳6' => '房', '巳0' => '危',
      '酉1' => '轸', '酉2' => '觜', '酉3' => '斗', '酉4' => '胃', '酉5' => '柳', '酉6' => '房', '酉0' => '危',
      '丑1' => '轸', '丑2' => '觜', '丑3' => '斗', '丑4' => '胃', '丑5' => '柳', '丑6' => '房', '丑0' => '危',
      
      '寅1' => '角', '寅2' => '参', '寅3' => '牛', '寅4' => '昴', '寅5' => '星', '寅6' => '心', '寅0' => '室',
      '午1' => '角', '午2' => '参', '午3' => '牛', '午4' => '昴', '午5' => '星', '午6' => '心', '午0' => '室',
      '戌1' => '角', '戌2' => '参', '戌3' => '牛', '戌4' => '昴', '戌5' => '星', '戌6' => '心', '戌0' => '室',
      
      '亥1' => '亢', '亥2' => '井', '亥3' => '女', '亥4' => '毕', '亥5' => '张', '亥6' => '尾', '亥0' => '壁',
      '卯1' => '亢', '卯2' => '井', '卯3' => '女', '卯4' => '毕', '卯5' => '张', '卯6' => '尾', '卯0' => '壁',
      '未1' => '亢', '未2' => '井', '未3' => '女', '未4' => '毕', '未5' => '张', '未6' => '尾', '未0' => '壁'
    }.freeze

    XIU_LUCK = {
      '角' => '吉', '亢' => '凶', '氐' => '凶', '房' => '吉', '心' => '凶', '尾' => '吉', '箕' => '吉',
      '斗' => '吉', '牛' => '凶', '女' => '凶', '虚' => '凶', '危' => '凶', '室' => '吉', '壁' => '吉',
      '奎' => '凶', '娄' => '吉', '胃' => '吉', '昴' => '凶', '毕' => '吉', '觜' => '凶', '参' => '吉',
      '井' => '吉', '鬼' => '凶', '柳' => '凶', '星' => '凶', '张' => '吉', '翼' => '凶', '轸' => '吉'
    }.freeze

    XIU_SONG = {
      '角' => '角星造作主荣昌，外进田财及女郎，嫁娶婚姻出贵子，文人及第见君王，惟有埋葬不可用，三年之后主瘟疫，起工修筑坟基地，堂前立见主人凶。',
      '亢' => '亢星造作长房当，十日之中主有殃，田地消磨官失职，接运定是虎狼伤，嫁娶婚姻用此日，儿孙新妇守空房，埋葬若还用此日，当时害祸主重伤。',
      '氐' => '氐星造作主灾凶，费尽田园仓库空，埋葬不可用此日，悬绳吊颈祸重重，若是婚姻离别散，夜招浪子入房中，行船必定遭沉没，更生聋哑子孙穷。',
      '房' => '房星造作田园进，钱财牛马遍山岗，更招外处田庄宅，荣华富贵福禄康，埋葬若然用此日，高官进职拜君王，嫁娶嫦娥至月殿，三年抱子至朝堂。',
      '心' => '心星造作大为凶，更遭刑讼狱囚中，忤逆官非宅产退，埋葬卒暴死相从，婚姻若是用此日，子死儿亡泪满胸，三年之内连遭祸，事事教君没始终。',
      '尾' => '尾星造作主天恩，富贵荣华福禄增，招财进宝兴家宅，和合婚姻贵子孙，埋葬若能依此日，男清女正子孙兴，开门放水招田宅，代代公侯远播名。',
      '箕' => '箕星造作主高强，岁岁年年大吉昌，埋葬修坟大吉利，田蚕牛马遍山岗，开门放水招田宅，箧满金银谷满仓，福荫高官加禄位，六亲丰禄乐安康。',
      '斗' => '斗星造作主招财，文武官员位鼎台，田宅家财千万进，坟堂修筑贵富来，开门放水招牛马，旺蚕男女主和谐，遇此吉宿来照护，时支福庆永无灾。',
      '牛' => '牛星造作主灾危，九横三灾不可推，家宅不安人口退，田蚕不利主人衰，嫁娶婚姻皆自损，金银财谷渐无之，若是开门并放水，牛猪羊马亦伤悲。',
      '女' => '女星造作损婆娘，兄弟相嫌似虎狼，埋葬生灾逢鬼怪，颠邪疾病主瘟惶，为事遭官财失散，泻利留连不可当，开门放水用此日，全家财散主离乡。',
      '虚' => '虚星造作主灾殃，男女孤眠不一双，内乱风声无礼节，儿孙媳妇伴人床，开门放水遭灾祸，虎咬蛇伤又卒亡，三三五五连年病，家破人亡不可当。',
      '危' => '危星不可造高楼，自遭刑吊见血光，三年孩子遭水厄，后生出外永不还，埋葬若还逢此日，周年百日取高堂，三年两载一悲伤，开门放水到官堂。',
      '室' => '室星修造进田牛，儿孙代代近王侯，家贵荣华天上至，寿如彭祖八千秋，开门放水招财帛，和合婚姻生贵儿，埋葬若能依此日，门庭兴旺福无休。',
      '壁' => '壁星造作主增财，丝蚕大熟福滔天，奴婢自来人口进，开门放水出英贤，埋葬招财官品进，家中诸事乐陶然，婚姻吉利主贵子，早播名誉著祖鞭。',
      '奎' => '奎星造作得祯祥，家内荣和大吉昌，若是埋葬阴卒死，当年定主两三伤，看看军令刑伤到，重重官事主瘟惶，开门放水遭灾祸，三年两次损儿郎。',
      '娄' => '娄星修造起门庭，财旺家和事事兴，外进钱财百日进，一家兄弟播高名，婚姻进益生贵子，玉帛金银箱满盈，放水开门皆吉利，男荣女贵寿康宁。',
      '胃' => '胃星造作事如何，家贵荣华喜气多，埋葬贵临官禄位，夫妇齐眉永保康，婚姻遇此家富贵，三灾九祸不逢他，从此门前多吉庆，儿孙代代拜金阶。',
      '昴' => '昴星造作进田牛，埋葬官灾不得休，重丧二日三人死，尽卖田园不记增，开门放水招灾祸，三岁孩儿白了头，婚姻不可逢此日，死别生离是可愁。',
      '毕' => '毕星造作主光前，买得田园有余钱，埋葬此日添官职，田蚕大熟永丰年，开门放水多吉庆，合家人口得安然，婚姻若得逢此日，生得孩儿福寿全。',
      '觜' => '觜星造作有徒刑，三年必定主伶丁，埋葬卒死多因此，取定寅年使杀人，三丧不止皆由此，一人药毒二人身，家门田地皆退败，仓库金银化作尘。',
      '参' => '参星造作旺人家，文星照耀大光华，只因造作田财旺，埋葬招疾哭黄沙，开门放水加官职，房房子孙见田加，婚姻许遁遭刑克，男女朝开幕落花。',
      '井' => '井星造作旺蚕田，金榜题名第一光，埋葬须防惊卒死，狂颠风疾入黄泉，开门放水招财帛，牛马猪羊旺莫言，贵人田塘来入宅，儿孙兴旺有余钱。',
      '鬼' => '鬼星起造卒人亡，堂前不见主人郎，埋葬此日官禄至，儿孙代代近君王，开门放水须伤死，嫁娶夫妻不久长，修土筑墙伤产女，手扶双女泪汪汪。',
      '柳' => '柳星造作主遭官，昼夜偷闭不暂安，埋葬瘟惶多疾病，田园退尽守冬寒，开门放水遭聋瞎，腰驼背曲似弓弯，更有棒刑宜谨慎，妇人随客走盘桓。',
      '星' => '星宿日好造新房，进职加官近帝王，不可埋葬并放水，凶星临位女人亡，生离死别无心恋，要自归休别嫁郎，孔子九曲殊难度，放水开门天命伤。',
      '张' => '张星日好造龙轩，年年并见进庄田，埋葬不久升官职，代代为官近帝前，开门放水招财帛，婚姻和合福绵绵，田蚕人满仓库满，百般顺意自安然。',
      '翼' => '翼星不利架高堂，三年二载见瘟惶，埋葬若还逢此日，子孙必定走他乡，婚姻此日不宜利，归家定是不相当，开门放水家须破，少女恋花贪外郎。',
      '轸' => '轸星临水造龙宫，代代为官受皇封，富贵荣华增寿禄，库满仓盈自昌隆，埋葬文昌来照助，宅舍安宁不见凶，更有为官沾帝宠，婚姻龙子入龙宫。'
    }.freeze

    SHOU = {
      '东' => '青龙',
      '南' => '朱雀',
      '西' => '白虎',
      '北' => '玄武'
    }.freeze

    CHONG = %w[午 未 申 酉 戌 亥 子 丑 寅 卯 辰 巳].freeze
    CHONG_GAN = %w[戊 己 庚 辛 壬 癸 甲 乙 丙 丁].freeze
    CHONG_GAN_TIE = %w[己 戊 辛 庚 癸 壬 乙 甲 丁 丙].freeze
    CHONG_GAN_4 = ['庚', '辛', '壬', '癸', '', '', '甲', '乙', '丙', '丁'].freeze
    HE_GAN_5 = %w[己 庚 辛 壬 癸 甲 乙 丙 丁 戊].freeze
    HE_ZHI_6 = %w[丑 子 亥 戌 酉 申 未 午 巳 辰 卯 寅].freeze

    SHA = {
      '子' => '南', '丑' => '东', '寅' => '北', '卯' => '西',
      '辰' => '南', '巳' => '东', '午' => '北', '未' => '西',
      '申' => '南', '酉' => '东', '戌' => '北', '亥' => '西'
    }.freeze

    POSITION_DESC = {
      '坎' => '正北', '艮' => '东北', '震' => '正东', '巽' => '东南',
      '离' => '正南', '坤' => '西南', '兑' => '正西', '乾' => '西北',
      '中' => '中宫'
    }.freeze

    GONG = {
      '角' => '东', '井' => '南', '奎' => '西', '斗' => '北',
      '亢' => '东', '鬼' => '南', '娄' => '西', '牛' => '北',
      '氐' => '东', '柳' => '南', '胃' => '西', '女' => '北',
      '房' => '东', '星' => '南', '昴' => '西', '虚' => '北',
      '心' => '东', '张' => '南', '毕' => '西', '危' => '北',
      '尾' => '东', '翼' => '南', '觜' => '西', '室' => '北',
      '箕' => '东', '轸' => '南', '参' => '西', '壁' => '北'
    }.freeze

    ZHENG = {
      '角' => '木', '井' => '木', '奎' => '木', '斗' => '木',
      '亢' => '金', '鬼' => '金', '娄' => '金', '牛' => '金',
      '氐' => '土', '柳' => '土', '胃' => '土', '女' => '土',
      '房' => '日', '星' => '日', '昴' => '日', '虚' => '日',
      '心' => '月', '张' => '月', '毕' => '月', '危' => '月',
      '尾' => '火', '翼' => '火', '觜' => '火', '室' => '火',
      '箕' => '水', '轸' => '水', '参' => '水', '壁' => '水'
    }.freeze

    ANIMAL = {
      '角' => '蛟', '斗' => '獬', '奎' => '狼', '井' => '犴',
      '亢' => '龙', '牛' => '牛', '娄' => '狗', '鬼' => '羊',
      '女' => '蝠', '氐' => '貉', '胃' => '彘', '柳' => '獐',
      '房' => '兔', '虚' => '鼠', '昴' => '鸡', '星' => '马',
      '心' => '狐', '危' => '燕', '毕' => '乌', '张' => '鹿',
      '尾' => '虎', '室' => '猪', '觜' => '猴', '翼' => '蛇',
      '箕' => '豹', '壁' => '獝', '参' => '猿', '轸' => '蚓'
    }.freeze

    WU_XING_GAN = {
      '甲' => '木', '乙' => '木', '丙' => '火', '丁' => '火',
      '戊' => '土', '己' => '土', '庚' => '金', '辛' => '金',
      '壬' => '水', '癸' => '水'
    }.freeze

    WU_XING_ZHI = {
      '寅' => '木', '卯' => '木', '巳' => '火', '午' => '火',
      '辰' => '土', '丑' => '土', '戌' => '土', '未' => '土',
      '申' => '金', '酉' => '金', '亥' => '水', '子' => '水'
    }.freeze

    WU_XING_NA_YIN = {
      '海中金' => '金', '炉中火' => '火', '大林木' => '木', '路旁土' => '土',
      '剑锋金' => '金', '山头火' => '火', '涧下水' => '水', '城头土' => '土',
      '白蜡金' => '金', '杨柳木' => '木', '泉中水' => '水', '屋上土' => '土',
      '霹雳火' => '火', '松柏木' => '木', '长流水' => '水', '沙中金' => '金',
      '山下火' => '火', '平地木' => '木', '壁上土' => '土', '金箔金' => '金',
      '覆灯火' => '火', '天河水' => '水', '大驿土' => '土', '钗钏金' => '金',
      '桑柘木' => '木', '大溪水' => '水', '沙中土' => '土', '天上火' => '火',
      '石榴木' => '木', '大海水' => '水'
    }.freeze

    SHI_SHEN_GAN = {
      '甲甲' => '比肩', '甲乙' => '劫财', '甲丙' => '食神', '甲丁' => '伤官',
      '甲戊' => '偏财', '甲己' => '正财', '甲庚' => '七杀', '甲辛' => '正官',
      '甲壬' => '偏印', '甲癸' => '正印', '乙乙' => '比肩', '乙甲' => '劫财',
      '乙丁' => '食神', '乙丙' => '伤官', '乙己' => '偏财', '乙戊' => '正财',
      '乙辛' => '七杀', '乙庚' => '正官', '乙癸' => '偏印', '乙壬' => '正印',
      '丙丙' => '比肩', '丙丁' => '劫财', '丙戊' => '食神', '丙己' => '伤官',
      '丙庚' => '偏财', '丙辛' => '正财', '丙壬' => '七杀', '丙癸' => '正官',
      '丙甲' => '偏印', '丙乙' => '正印', '丁丁' => '比肩', '丁丙' => '劫财',
      '丁己' => '食神', '丁戊' => '伤官', '丁辛' => '偏财', '丁庚' => '正财',
      '丁癸' => '七杀', '丁壬' => '正官', '丁乙' => '偏印', '丁甲' => '正印',
      '戊戊' => '比肩', '戊己' => '劫财', '戊庚' => '食神', '戊辛' => '伤官',
      '戊壬' => '偏财', '戊癸' => '正财', '戊甲' => '七杀', '戊乙' => '正官',
      '戊丙' => '偏印', '戊丁' => '正印', '己己' => '比肩', '己戊' => '劫财',
      '己辛' => '食神', '己庚' => '伤官', '己癸' => '偏财', '己壬' => '正财',
      '己乙' => '七杀', '己甲' => '正官', '己丁' => '偏印', '己丙' => '正印',
      '庚庚' => '比肩', '庚辛' => '劫财', '庚壬' => '食神', '庚癸' => '伤官',
      '庚甲' => '偏财', '庚乙' => '正财', '庚丙' => '七杀', '庚丁' => '正官',
      '庚戊' => '偏印', '庚己' => '正印', '辛辛' => '比肩', '辛庚' => '劫财',
      '辛癸' => '食神', '辛壬' => '伤官', '辛乙' => '偏财', '辛甲' => '正财',
      '辛丁' => '七杀', '辛丙' => '正官', '辛己' => '偏印', '辛戊' => '正印',
      '壬壬' => '比肩', '壬癸' => '劫财', '壬甲' => '食神', '壬乙' => '伤官',
      '壬丙' => '偏财', '壬丁' => '正财', '壬戊' => '七杀', '壬己' => '正官',
      '壬庚' => '偏印', '壬辛' => '正印', '癸癸' => '比肩', '癸壬' => '劫财',
      '癸乙' => '食神', '癸甲' => '伤官', '癸丁' => '偏财', '癸丙' => '正财',
      '癸己' => '七杀', '癸戊' => '正官', '癸辛' => '偏印', '癸庚' => '正印'
    }.freeze

    SHI_SHEN_ZHI = {
      '甲子' => ['癸'], '甲丑' => ['己', '癸', '辛'], '甲寅' => ['甲', '丙', '戊'],
      '甲卯' => ['乙'], '甲辰' => ['戊', '乙', '癸'], '甲巳' => ['丙', '庚', '戊'],
      '甲午' => ['丁', '己'], '甲未' => ['己', '丁', '乙'], '甲申' => ['庚', '壬', '戊'],
      '甲酉' => ['辛'], '甲戌' => ['戊', '辛', '丁'], '甲亥' => ['壬', '甲'],
      '乙子' => ['癸'], '乙丑' => ['己', '癸', '辛'], '乙寅' => ['甲', '丙', '戊'],
      '乙卯' => ['乙'], '乙辰' => ['戊', '乙', '癸'], '乙巳' => ['丙', '庚', '戊'],
      '乙午' => ['丁', '己'], '乙未' => ['己', '丁', '乙'], '乙申' => ['庚', '壬', '戊'],
      '乙酉' => ['辛'], '乙戌' => ['戊', '辛', '丁'], '乙亥' => ['壬', '甲'],
      '丙子' => ['癸'], '丙丑' => ['己', '癸', '辛'], '丙寅' => ['甲', '丙', '戊'],
      '丙卯' => ['乙'], '丙辰' => ['戊', '乙', '癸'], '丙巳' => ['丙', '庚', '戊'],
      '丙午' => ['丁', '己'], '丙未' => ['己', '丁', '乙'], '丙申' => ['庚', '壬', '戊'],
      '丙酉' => ['辛'], '丙戌' => ['戊', '辛', '丁'], '丙亥' => ['壬', '甲'],
      '丁子' => ['癸'], '丁丑' => ['己', '癸', '辛'], '丁寅' => ['甲', '丙', '戊'],
      '丁卯' => ['乙'], '丁辰' => ['戊', '乙', '癸'], '丁巳' => ['丙', '庚', '戊'],
      '丁午' => ['丁', '己'], '丁未' => ['己', '丁', '乙'], '丁申' => ['庚', '壬', '戊'],
      '丁酉' => ['辛'], '丁戌' => ['戊', '辛', '丁'], '丁亥' => ['壬', '甲'],
      '戊子' => ['癸'], '戊丑' => ['己', '癸', '辛'], '戊寅' => ['甲', '丙', '戊'],
      '戊卯' => ['乙'], '戊辰' => ['戊', '乙', '癸'], '戊巳' => ['丙', '庚', '戊'],
      '戊午' => ['丁', '己'], '戊未' => ['己', '丁', '乙'], '戊申' => ['庚', '壬', '戊'],
      '戊酉' => ['辛'], '戊戌' => ['戊', '辛', '丁'], '戊亥' => ['壬', '甲'],
      '己子' => ['癸'], '己丑' => ['己', '癸', '辛'], '己寅' => ['甲', '丙', '戊'],
      '己卯' => ['乙'], '己辰' => ['戊', '乙', '癸'], '己巳' => ['丙', '庚', '戊'],
      '己午' => ['丁', '己'], '己未' => ['己', '丁', '乙'], '己申' => ['庚', '壬', '戊'],
      '己酉' => ['辛'], '己戌' => ['戊', '辛', '丁'], '己亥' => ['壬', '甲'],
      '庚子' => ['癸'], '庚丑' => ['己', '癸', '辛'], '庚寅' => ['甲', '丙', '戊'],
      '庚卯' => ['乙'], '庚辰' => ['戊', '乙', '癸'], '庚巳' => ['丙', '庚', '戊'],
      '庚午' => ['丁', '己'], '庚未' => ['己', '丁', '乙'], '庚申' => ['庚', '壬', '戊'],
      '庚酉' => ['辛'], '庚戌' => ['戊', '辛', '丁'], '庚亥' => ['壬', '甲'],
      '辛子' => ['癸'], '辛丑' => ['己', '癸', '辛'], '辛寅' => ['甲', '丙', '戊'],
      '辛卯' => ['乙'], '辛辰' => ['戊', '乙', '癸'], '辛巳' => ['丙', '庚', '戊'],
      '辛午' => ['丁', '己'], '辛未' => ['己', '丁', '乙'], '辛申' => ['庚', '壬', '戊'],
      '辛酉' => ['辛'], '辛戌' => ['戊', '辛', '丁'], '辛亥' => ['壬', '甲'],
      '壬子' => ['癸'], '壬丑' => ['己', '癸', '辛'], '壬寅' => ['甲', '丙', '戊'],
      '壬卯' => ['乙'], '壬辰' => ['戊', '乙', '癸'], '壬巳' => ['丙', '庚', '戊'],
      '壬午' => ['丁', '己'], '壬未' => ['己', '丁', '乙'], '壬申' => ['庚', '壬', '戊'],
      '壬酉' => ['辛'], '壬戌' => ['戊', '辛', '丁'], '壬亥' => ['壬', '甲'],
      '癸子' => ['癸'], '癸丑' => ['己', '癸', '辛'], '癸寅' => ['甲', '丙', '戊'],
      '癸卯' => ['乙'], '癸辰' => ['戊', '乙', '癸'], '癸巳' => ['丙', '庚', '戊'],
      '癸午' => ['丁', '己'], '癸未' => ['己', '丁', '乙'], '癸申' => ['庚', '壬', '戊'],
      '癸酉' => ['辛'], '癸戌' => ['戊', '辛', '丁'], '癸亥' => ['壬', '甲']
    }.freeze

    ZHI_HIDE_GAN = {
      '子' => ['癸'], '丑' => ['己', '癸', '辛'], '寅' => ['甲', '丙', '戊'],
      '卯' => ['乙'], '辰' => ['戊', '乙', '癸'], '巳' => ['丙', '庚', '戊'],
      '午' => ['丁', '己'], '未' => ['己', '丁', '乙'], '申' => ['庚', '壬', '戊'],
      '酉' => ['辛'], '戌' => ['戊', '辛', '丁'], '亥' => ['壬', '甲']
    }.freeze

    CHANG_SHENG = %w[长生 沐浴 冠带 临官 帝旺 衰 病 死 墓 绝 胎 养].freeze

    CHANG_SHENG_OFFSET = {
      '甲' => 1, '丙' => 10, '戊' => 10, '庚' => 7, '壬' => 4,
      '乙' => 6, '丁' => 9, '己' => 9, '辛' => 0, '癸' => 3
    }.freeze
  end
end